version: 0

env:
  DATABASE_URI: postgres://postgres:password@localhost:5432/postgres

var:
  CURRENT_DATE:
    generate: date '+%Y-%m%d-%H%M%S'
    # generate: echo 2024-1011-140230

prep:
  steps:
  - name: なんか準備
    run: mkdir -p ./devdata/${CURRENT_DATE}
  - name: ファイル作成
    run: |
      echo "hello" > ./devdata/${CURRENT_DATE}/hello.txt

main:
  jobs:
  - name: ファイルの中身確認
    run: cat ./devdata/${CURRENT_DATE}/hello.txt
    label: check
  - name: 継続的なジョブ
    run: sleep 2 && echo "done 2s"
  - name: 継続的なジョブ（長い）
    run: sleep 20 && echo "done 20s"

post:
  steps:
  - name: 後処理
    run: rm -rf ./devdata/${CURRENT_DATE}